---
title: "Alternative delay plot"
author: "Group 4"
date: "`r Sys.Date()`"
output: pdf_document
# the following puts the knitted file in the Outputs folder
knit: (function(inputFile, encoding) {
      out_dir <- "../Outputs";
      rmarkdown::render(inputFile,
                        encoding=encoding,
                        output_dir=file.path(dirname(inputFile), out_dir))})
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

```{r}
# Code to get the data for the basic IAH plot
## copied from delay-plot-starter-code.R
delays <- read_csv("http://vis.cwick.co.nz/data/all-summary.csv")
# see: 04-get-delay-summary.R for details of summarization

delays$DayOfWeek <- factor(delays$DayOfWeek, 
  levels = c("Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"))

# our plot for IAH
iah <- subset(delays, Origin == "IAH")
ggplot(iah, aes(DepHour, DayOfWeek)) +
  geom_tile(aes(fill = prop_over_15)) 

# but now there are also flights from HOU 
hou <- subset(delays, Origin == "HOU") %>% 
  filter(Origin == "HOU")
```


```{r}
# Get all flight delay data
## copied from get-delay-summary.R
library(hflights)    # NOTE FROM ANDREA: typically not great to load libraries 
                     # all the way down here, but I wanted to make it clear that 
                     # this library isn't needed for the basic plot.

hflights_df <- tbl_df(hflights)

hflights_df <- mutate(hflights_df, 
  DepHour = floor(DepTime/100),
  DayOfWeek = factor(DayOfWeek, 
    labels = c("Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"))
)

day_hour <- group_by(hflights_df, Origin, DepHour, DayOfWeek)
day_hour_sum <- summarise(day_hour, 
  avg_delay = mean(DepDelay, na.rm = TRUE),
  avg_delay_delayed = mean(DepDelay[DepDelay > 0], 
    na.rm = TRUE),
  prop_over_15 = mean(DepDelay > 15, na.rm = TRUE),
  nflights  = n(),
  ndests = n_distinct(Dest)
)

# write_csv(day_hour_sum, "all-summary.csv")
```

# OUR GRAPH
```{r}

```

